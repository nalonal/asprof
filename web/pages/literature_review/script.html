
<script src="{{ url_for('static', filename='assets/vendors/datatables.net/js/jquery.dataTables.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-buttons/js/dataTables.buttons.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-buttons/js/buttons.flash.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-buttons/js/buttons.html5.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-responsive/js/dataTables.responsive.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js') }}"></script>
<script src="{{ url_for('static', filename='assets/vendors/datatables.net-scroller/js/dataTables.scroller.min.js') }}"></script>
<!-- AJAX BROO -->
<script>
$(document).ready(function(){
	$(document).on("click",'.save-review',function(){
		var row_to_close = $(this).closest('li')
		slr_id = $(this).closest('li').find('.slr_id').val()
		keyword = $(this).closest('li').find('.paper_keyword').val()
		resume = $(this).closest('li').find('textarea').val()
		$('.float-message-wait').show();
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/save_review',
			data: JSON.stringify({'slr_id':slr_id,'resume':resume,'keyword':keyword}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				// $("#id").css("display", "none");
				// setTimeout(() => { $('.float-message-wait').hide(); }, 1000);
				$('.float-message-wait').hide();
				$('.float-message-success').show();
				setTimeout(() => { $('.float-message-success').hide(); }, 5000);
				// row_to_close.remove()
				// location.reload();
			},
			error: function (data)
			{
			}
		});
		// alert(keyword)
	});

	$(document).on("click",'.eliminate-review',function(){
		var row_to_close = $(this).closest('li')
		slr_id = $(this).closest('li').find('input').val()
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/eliminated',
			data: JSON.stringify({'slr_id':slr_id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				row_to_close.remove()
				// location.reload();
			},
			error: function (data)
			{
			}
		});
		// alert(slr_id)
	});


	$(document).on("click",'.unrelated',function(){
		var row_to_close = $(this).closest('li')
		slr_id = $(this).closest('li').find('input').val()
		
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/unrelated',
			data: JSON.stringify({'slr_id':slr_id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				row_to_close.remove()
				// location.reload();
			},
			error: function (data)
			{
			}
		});
		// alert(slr_id)
	});

	$(document).on("click",'.related',function(){
		var row_to_close = $(this).closest('li')
		slr_id = $(this).closest('li').find('input').val()
		
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/related',
			data: JSON.stringify({'slr_id':slr_id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				row_to_close.remove()
				// location.reload();
			},
			error: function (data)
			{
			}
		});
		// alert(slr_id)
	});


  $("#tambah_action").click(function(){
  	var research_title = $("#research_title"). val();
  	var research_author = $("#research_author"). val();
	$.ajax({
		type: "POST",
		url: root+'/literature_review/add',
		data: JSON.stringify({'research_title':research_title,'research_author':research_author}),
		dataType: 'json',
		headers: {
			'Content-Type': 'application/json'
		},
		success: function(output)
		{
			location.reload();
		},
		error: function (data)
		{
		}
	});

  });



  $("#save_research_information").click(function(){
  	var id = $("#input_research_id"). val();
  	var research_title = $("#input_research_title"). val();
	var research_author = $("#input_research_author"). val();

	var research_question = $("#input_research_question"). val();
  	var research_identification = $("#input_research_identification"). val();
	var research_question_list_template = $("#input_research_question_list_template"). val();
	
	$.ajax({
		type: "POST",
		url: root+'/literature_review/update',
		data: JSON.stringify({'id':id,'research_title':research_title,'research_author':research_author,'research_question':research_question,'research_identification':research_identification,'research_question_list_template':research_question_list_template}),
		dataType: 'json',
		headers: {
			'Content-Type': 'application/json'
		},
		success: function(output)
		{
			location.reload();
		},
		error: function (data)
		{
		}
	});

  });

  $("#output_save_research").click(function(){
  	var id = $("#input_research_id"). val();
	var research_text = CKEDITOR.instances['text'].getData();
	$('.float-message-wait').show();
	$.ajax({
		type: "POST",
		url: root+'/literature_review/update/output',
		data: JSON.stringify({'id':id,'output':research_text}),
		dataType: 'json',
		headers: {
			'Content-Type': 'application/json'
		},
		success: function(output)
		{
			$('.float-message-wait').hide();
			$('.float-message-success').show();
		},
		error: function (data)
		{
		}
	});

  });


	$("#save_research_remove").click(function(){
		var id = $("#input_research_id"). val();
		$.ajax({
			type: "POST",
			url: root+'/literature_review/delete',
			data: JSON.stringify({'id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				window.open(root+'/literature_review',"_self")
			},
			error: function (data)
			{
			}
		});

	});



	// Start AUTOMATION
	

	$("#start_automation_all").click(function(){
		var id = $("#input_research_id"). val();
		// alert(id)
		$.ajax({
			type: "POST",
			url: root+'/api/automate_openai',
			data: JSON.stringify({'id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				// window.open(root+'/literature_review',"_self")
			},
			error: function (data)
			{
			}
		});

	});

	$("#start_automation_paper").click(function(){
		var id = $("#input_research_id"). val();
		// alert(id)
		$.ajax({
			type: "POST",
			url: root+'/api/automate_openai_paper',
			data: JSON.stringify({'id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				$('.float-message-success').show();
				setTimeout(() => { $('.float-message-success').hide(); }, 5000);
				// window.open(root+'/literature_review',"_self")
			},
			error: function (data)
			{
			}
		});

	});

	$("#start_automation_literature").click(function(){
		var id = $("#input_research_id"). val();
		// alert(id)
		$.ajax({
			type: "POST",
			url: root+'/api/automate_openai_literature',
			data: JSON.stringify({'id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				$('.float-message-success').show();
				setTimeout(() => { $('.float-message-success').hide(); }, 5000);
				// window.open(root+'/literature_review',"_self")
			},
			error: function (data)
			{
			}
		});

	});



	$("#test_research_keyword").click(function(){
		var input_keyword = $("#input_research_keyword"). val();
		$("#waitingtext").text("Please Wait Until the Proccess Finish");

		$.ajax({
			type: "POST",
			url: root+'/api/start_count_total',
			data: JSON.stringify({'input_keyword':input_keyword}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				var ieee = output['data']['ieee']
				var sciencedirect = output['data']['sciencedirect']
				var acm = output['data']['acm']
				$('#waitingtext').html('Result IEEE:'+ieee+', ScienceDirect:'+sciencedirect+', ACM Library:'+acm);
				// window.open(root+'/literature_review',"_self")
			},
			error: function (data)
			{
			}
		});

	});

	$("#save_research_keyword").click(function(){
		var id = $("#input_research_id"). val();
		var research_keyword= $("#input_research_keyword"). val();
		$.ajax({
			type: "POST",
			url: root+'/literature_review/rk/update',
			data: JSON.stringify({'id':id,'research_keyword':research_keyword}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				location.reload();
			},
			error: function (data)
			{
			}
		});

	});


	$("#generate_research_result").click(function(){
		var id = $("#input_research_id"). val();
		// var research_keyword= $("#input_research_keyword"). val();
		$('.float-message-wait').show();
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/result_crawling',
			data: JSON.stringify({'research_id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				$('.float-message-wait').hide();
				$('.float-message-success').show();
				setTimeout(() => { $('.float-message-success').hide(); }, 5000);
			},
			error: function (data)
			{
			}
		});

	});

	$("#output_generate_research").click(function(){
		var id = $("#input_research_id"). val();
		// var research_keyword= $("#input_research_keyword"). val();
		$('.float-message-wait').show();
		$.ajax({
			type: "POST",
			url: root+'/literature_review/slr/generate_research',
			data: JSON.stringify({'research_id':id}),
			dataType: 'json',
			headers: {
				'Content-Type': 'application/json'
			},
			success: function(output)
			{
				$('.float-message-wait').hide();
				$('.float-message-success').show();
				setTimeout(() => { $('.float-message-success').hide(); }, 5000);
				location.reload();
			},
			error: function (data)
			{
			}
		});

	});


});

</script>
