<style>
  table, th, td {
    border:1px solid black;
    color: black;
  }
</style>
<script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<style type="text/css">
  #mynetwork {
    width: 90%;
    height: 600px;
    border: 1px solid lightgray;
  }
</style>

<div class="row">  
    <div class="col-md-12 col-sm-12 ">
      <div class="x_panel">
        <div class="x_title">
          <p style="width: 100%; color: black; overflow-wrap: break-word; font-size: 20px;"><a href="{{ url_for('literature_review') }}" class="btn btn-info btn-sms" style="font-size: 12px"><i class="fa fa-arrow-left"></i> Back</a><br>{{ title }} : {{ output['data'][1] }}</p>
          <div class="clearfix"></div>
        </div>
        <div class="x_content">
      <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  
      <div class="container bootdey">
        <div class="email-app">
            {% include 'pages/literature_review/menu.html' %}
            <main>  
              <nav class="nav nav-tabs">
                
                <a class="nav-link" href="{{ url_for('literature_review_bb_resume', id=id) }}">Bibliometric Resume</a>
                <a class="nav-link" href="{{ url_for('literature_review_bb_author', id=id) }}">SNA Author</a>
                <a class="nav-link active" href="{{ url_for('literature_review_bb', id=id) }}">SNA Keyword</a>
              </nav>
                <input type="hidden" class="form-control" id="input_research_id" value="{{ id }}">
                <button id="save_bibliometric_diagram" class="btn-lg btn-success">Store All Image</button><br><br>
                <div id="mynetwork"></div>
            </main>
            
        </div>
      </div>
      </div>
      <!-- XPANEL -->
    </div>
    <!-- COL-12 -->
  </div>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script>

$(document).on("click",'#save_bibliometric_diagram',function(){
        html2canvas($("#mynetwork")[0]).then((canvas) => {
            var imgData = canvas.toDataURL('image/png');
            var id = $("#input_research_id"). val();
            $.ajax({
              type: "POST",
              url: root+'/literature_review/slr/bibliometric_update_keyword',
              data: {'id':id,'img_data': imgData},
              success: function(response) {
                $('.float-message-wait').hide();
                $('.float-message-success').show();
                setTimeout(() => { $('.float-message-success').hide(); }, 5000);
              }
            });
      });
    });


var nodesDataSet = new vis.DataSet({{output['research']['nodes_data']}});
var edgesDataSet = new vis.DataSet({{output['research']['edges_data']}});
// Set options for the network
var options = {
  layout: {
    improvedLayout: false
  },
  nodes: {
    shapeProperties: {
      interpolation: false    // 'true' for intensive zooming
    },
    shape: "dot",
    scaling: {
      min: 10,
      max: 30,
      label: {
        enabled: true,
        min: 20,
        max: 100,
        maxVisible: 100,
        drawThreshold: 7
      }
    },
    color: {
      background: function(node) {
        // Set the node color based on the cluster ID
        var clusterColors = ["#FFC107", "#2196F3", "#4CAF50", "#9C27B0", "#FF5722"];
        return clusterColors[node.group];
      }
    }
  }
};

// Create the network object
var container = document.getElementById("mynetwork");
var data = {
  nodes: nodesDataSet,
  edges: edgesDataSet
};
var network = new vis.Network(container, data, options);  
    </script>


